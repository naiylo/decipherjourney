var S2CSFRToken;(()=>{"use strict";var e={d:(n,t)=>{for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};(()=>{function t(e){var n=!1;function t(){n||(n=!0,e())}"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?t():window.addEventListener("DOMContentLoaded",t)}function r(){var e,n=null,r=Date.now()+45e3,o=[];function a(){n=document.getElementsByTagName("form"),e||(e=window.setInterval(u,2490))}function i(){for(var e=document.getElementsByTagName("a"),n=[],t=0;t<e.length;t++){var r=e[t].getAttribute("href");r&&r.match(/&(csfr|csrf|s2preview)(=|&|#|$)/)&&n.push(e[t])}return n}function l(e,t){for(var r=0;r<n.length;r++)d(n[r],e,t);var o=i();for(r=0;r<o.length;r++)h(o[r],e,t)}function u(){if(!(Date.now()<r)){r=Date.now()+45e3;for(var e={},t=0;t<n.length;t++)new c(n[t],e);var o=i();for(t=0;t<o.length;t++)new v(o[t],e)}}function f(e){for(var n=e.getElementsByTagName("input"),t=0;t<n.length;t++)if("csfr"===n[t].getAttribute("name")&&n[t].value)return n[t];return null}function s(n,t){if(!t)throw"Must not use GeneralRefresher() without a token.";if(!(t in n)){n[t]=1;var r=new XMLHttpRequest;r.open("POST","csfr.php",!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send("csfr="+encodeURIComponent(t)),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var e=JSON.parse(r.responseText);if(e&&e.status){if("ok"!==e.status)if("changed"!==e.status){if(!e.fail)return console.warn("No failure information for CSFR token status "+e.status),void a(5);"invalid"===e.fail?a(4):"user"===e.fail?a(2):"project"===e.fail?a(3):a(5)}else{var n=e.token;l(t,n)}}else a(5)}else a(5)}}function a(n){1!==n&&(4===n?function(){0===o.length&&console.warn("Shall tell the S2CSRFToken what to do if receiving an [invalid] status.");for(var e=0;e<o.length;e++)o[e]()}():console.log("need handle "+n),e&&(window.clearInterval(e),e=null))}}function c(e,n){var t=f(e);if(t){var r=t.value;r&&s.call(this,n,r)}}function v(e,n){var t=function(e){var n=e.getAttribute("href");if(!n)return null;var t=n.split("?",2);if(2!==t.length)return null;for(var r=function(e){var n={};if(!e)return n;for(var t=e.split("&"),r=0;r<t.length;r++){var o=t[r].split("=",2),a=decodeURIComponent(o[0]);1===o.length?n[a]=!0:n[a]=decodeURIComponent(o[1])}return n}(t[1]),o=["csfr","csrf","s2preview","t"],a=null,i=0;i<o.length;i++)o[i]in r&&!0!==r[o[i]]&&(a=o[i]);return a?r[a]:null}(e);t&&s.call(this,n,t)}function d(e,n,t){var r=f(e);r&&r.value===n&&(r.value=t)}function h(e,n,t){var r=e.getAttribute("href");if(r){var o=r.split("?",2);if(2===o.length){var a=RegExp("(csfr|csrf|s2preview|t)="+n+"(&|#|$)"),i=o[0],l=o[1].replace(a,"$1="+t+"$2");e.setAttribute("href",i+"?"+l)}}}this.addEventListener=function(e,n){"invalid"===e?o.push(n):console.warn("The S2CSRFToken only can throw the event [invalid]")},this.getElements=function(){var e=i(),n=f();return n&&e.push(n),e},this.getFormToken=function(){n||a(),n||console.warn("No forms available");for(var e=0;e<n.length;e++){var t=f(n[e]);if(t&&t.value)return t.value}return null},this.getLinkToken=function(e){if(!e||"A"!==e.nodeName)return console.warn("Can only getLinkToken() from <a>",e),null;var n=e.getAttribute("href");if(!n)return console.warn("Can only getLinkToken() from href, which is missing",e),null;var t=n.split("?",2);if(2===t.length){var r=t[1].match(/(csfr|csrf|s2preview|t)=([a-z0-9]+)(&|#|$)/i);return r?r[2]:null}},this.updateToken=function(e,n){l(e,n)},t.onload(a)}function o(){return r.instance.getFormToken()}function a(e){return r.instance.getLinkToken(e)}function i(e,n){return r.instance.updateToken(e,n)}e.r(n),e.d(n,{getToken:()=>o,getTokenFromLink:()=>a,updateToken:()=>i}),t.onload=function(e){new t(e)},Date.now||(Date.now=function(){return(new Date).getTime()}),"instance"in r||(r.instance=new r)})(),S2CSFRToken=n})();